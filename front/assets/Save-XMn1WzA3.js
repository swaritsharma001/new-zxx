import{r as t,j as e,R as F,a as b}from"./index-ZNIShJOc.js";const D=({backend:r,setBlogs:o})=>{const[a,n]=t.useState(""),[s,u]=t.useState(""),[i,h]=t.useState(null),[d,g]=t.useState(""),[p,x]=t.useState(""),[j,y]=t.useState(""),w=t.useRef(null),C={toolbar:[[{header:[1,2,3,!1]}],["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],["link","image"],[{align:[]},{color:[]},{background:[]}],["code-block","blockquote"]],clipboard:{matchVisual:!1}};t.useEffect(()=>{const l=w.current.getEditor(),m=()=>{const c=document.createElement("input");c.setAttribute("type","file"),c.setAttribute("accept","image/*"),c.click(),c.onchange=async()=>{if(!c.files||!c.files.length)return;const B=c.files[0],N=new FormData;N.append("img",B);try{const v=await b.post(`${r}/blog/uploadImg`,N,{withCredentials:!0},{headers:{"Content-Type":"multipart/form-data"}}),E=l.getSelection();l.insertEmbed(E.index,"image",v.data.url)}catch(v){console.error("Error uploading image:",v)}}};l.getModule("toolbar").addHandler("image",m)},[r]);const S=l=>{const m=l.target.files[0];h(m),g(URL.createObjectURL(m))},k=async()=>{if(!a||!s||!i){x("Please fill in all fields.");return}const l=new FormData;l.append("Title",a),l.append("description",s),l.append("cover",i);try{const m=await b.post(`${r}/blog/upload`,l,{withCredentials:!0,headers:{"Content-Type":"multipart/form-data"}});y("Blog post saved successfully!"),o(c=>[...c,m.data.blog]),n(""),u(""),h(null),g(""),x("")}catch(m){console.error("Error saving blog post:",m),x("Failed to save the blog post. Please try again.")}};return e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold mb-6 text-center",children:"Create a New Blog Post"}),p&&e.jsx("div",{className:"mb-4 p-4 bg-red-100 text-red-800 rounded-md",children:p}),j&&e.jsx("div",{className:"mb-4 p-4 bg-green-100 text-green-800 rounded-md",children:j}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-lg font-medium mb-2",children:"Title"}),e.jsx("input",{type:"text",value:a,onChange:l=>n(l.target.value),className:"w-full p-3 border rounded-md"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-lg font-medium mb-2",children:"Cover Image"}),e.jsx("input",{type:"file",accept:"image/*",onChange:S,className:"w-full p-3 border rounded-md"}),d&&e.jsx("img",{src:d,alt:"Preview",className:"mt-4 w-full max-h-64"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-lg font-medium mb-2",children:"Description"}),e.jsx(F,{ref:w,value:s,onChange:u,modules:C})]}),e.jsx("button",{onClick:k,className:"w-full py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Submit"})]})},H=({blogs:r,handleDelete:o})=>e.jsx("div",{className:"bg-red-500 h-screen",children:r.map(a=>e.jsxs("div",{className:"p-4 mb-4 bg-white shadow-md",children:[e.jsx("h2",{className:"text-lg font-bold",children:a.Title}),e.jsx("button",{className:"mt-2 bg-red-700 text-white px-4 py-2 rounded",onClick:()=>o(a._id),children:"Delete"})]},a._id))}),L=({backend:r})=>{const[o,a]=t.useState(""),[n,s]=t.useState(null),[u,i]=t.useState(""),h=async d=>{d.preventDefault();const g=new FormData;g.append("Name",o),g.append("Logo",n);try{(await b.post(`${r}/blog/nav`,g,{withCredentials:!0})).status===200?i("Blog Header Updated Successfully"):i("Failed to Update Blog Header")}catch{i("An error occurred while updating the blog header")}setTimeout(()=>i(""),5e3)};return e.jsxs(e.Fragment,{children:[u&&e.jsx("div",{className:"bg-orange-500 rounded-lg p-4 border-2 border-orange-600 m-4","aria-live":"polite",children:u}),e.jsxs("form",{onSubmit:h,className:"mb-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-lg font-medium mb-2",htmlFor:"name",children:"Blog Name"}),e.jsx("input",{id:"name",type:"text",value:o,onChange:d=>a(d.target.value),className:"w-full p-3 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-lg font-medium mb-2",htmlFor:"logo",children:"Blog Logo"}),e.jsx("input",{id:"logo",type:"file",accept:"image/*",onChange:d=>s(d.target.files[0]),className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:bg-blue-500 file:text-white hover:file:bg-blue-600",required:!0})]}),e.jsx("button",{type:"submit",className:"w-full py-3 bg-gradient-to-r from-green-500 to-green-600 text-white font-medium rounded-md hover:from-green-600 hover:to-green-700 transition-all duration-300",children:"Save Header"})]})]})},f="https://worldtoday.me",T=()=>{const[r,o]=t.useState([]);t.useEffect(()=>{async function n(){try{const s=await b.get(`${f}/blog/allBlogs?page=1&limit=3000000000000088999999999999`);o(s.data.blogs)}catch(s){console.error("Error fetching blogs:",s)}}n()},[]);const a=async n=>{try{(await b.delete(`${f}/blog/delete/${n}`,{withCredentials:!0})).status===200?o(u=>u.filter(i=>i._id!==n)):console.error("Failed to delete the blog")}catch(s){console.error("Error deleting the blog:",s)}};return e.jsxs("div",{className:"container mx-auto p-4",children:[e.jsx(D,{backend:f}),e.jsx(H,{blogs:r,handleDelete:a}),e.jsx(L,{backend:f})]})};export{T as default};
